import{U as N,x as A,a9 as j,aa as H,ax as T,P as U,a3 as $,ay as M,az as O,a6 as R,S as z,aA as K,aB as L,aC as G,C as J,au as W,r as X,c as F,o as S,a as l,w as c,e as _,j as q,Q as D,b as o,F as Y,H as Z,u as h,I as Q,g as ee,i as te,k as w,M as ae,T as oe,N as ne,aD as I}from"./app-Dm8FEYe1.js";import{c as se,C as le}from"./utils-Dw_Aya8X.js";const re=N({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(f,{slots:V,emit:r}){const p=U(),u=A(null);let m=0;const i=[];function g(e){const v=typeof e=="boolean"?e:f.noErrorFocus!==!0,C=++m,k=(t,s)=>{r(`validation${t===!0?"Success":"Error"}`,s)},B=t=>{const s=t.validate();return typeof s.then=="function"?s.then(d=>({valid:d,comp:t}),d=>({valid:!1,comp:t,err:d})):Promise.resolve({valid:s,comp:t})};return(f.greedy===!0?Promise.all(i.map(B)).then(t=>t.filter(s=>s.valid!==!0)):i.reduce((t,s)=>t.then(()=>B(s).then(d=>{if(d.valid===!1)return Promise.reject(d)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return C===m&&k(!0),!0;if(C===m){const{comp:s,err:d}=t[0];if(d!==void 0&&console.error(d),k(!1,s),v===!0){const E=t.find(({comp:P})=>typeof P.focus=="function"&&O(P.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function b(){m++,i.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function a(e){e!==void 0&&R(e);const v=m+1;g().then(C=>{v===m&&C===!0&&(f.onSubmit!==void 0?r("submit",e):e?.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function x(e){e!==void 0&&R(e),r("reset"),z(()=>{b(),f.autofocus===!0&&f.noResetFocus!==!0&&n()})}function n(){K(()=>{if(u.value===null)return;(u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),v=>v.tabIndex!==-1))?.focus({preventScroll:!0})})}L(G,{bindComponent(e){i.push(e)},unbindComponent(e){const v=i.indexOf(e);v!==-1&&i.splice(v,1)}});let y=!1;return j(()=>{y=!0}),H(()=>{y===!0&&f.autofocus===!0&&n()}),T(()=>{f.autofocus===!0&&n()}),Object.assign(p.proxy,{validate:g,resetValidation:b,submit:a,reset:x,focus:n,getValidationComponents:()=>i}),()=>$("form",{class:"q-form",ref:u,onSubmit:a,onReset:x},M(V.default))}}),ue={class:"table-responsive"},ie={class:"table bordered"},de={class:"nowrap"},ce={class:"q-gutter-xs no-wrap"},fe={class:"card-title flex justify-between items-center"},me={class:"card-action"},ye={__name:"RoleIndex",setup(f){const V=J().props.data,r=W({name:""}),p=A(!1),u=A(null),m=()=>{u.value&&r.put(I.update(u.value.id).url,{preserveState:!1}),r.post(I.store().url,{preserveState:!1})},i=()=>{r.name="",p.value=!0},g=b=>{r.name=b.name,u.value=b,p.value=!0};return(b,a)=>{const x=X("AppHeader");return S(),F("div",null,[l(x,{title:"Roles"},{default:c(()=>[l(_,{color:"primary",onClick:i},{default:c(()=>[...a[2]||(a[2]=[q("Add Role",-1)])]),_:1})]),_:1}),l(w,{class:"section q-mt-md",flat:""},{default:c(()=>[l(D,null,{default:c(()=>[o("div",ue,[o("table",ie,[a[4]||(a[4]=o("thead",null,[o("tr",null,[o("th",{align:"left"},"#"),o("th",{align:"left"},"Name"),o("th",{align:"left"},"Action")])],-1)),o("tbody",null,[(S(!0),F(Y,null,Z(h(V),(n,y)=>(S(),F("tr",{key:y},[o("td",null,Q(y+1),1),o("td",null,[o("div",de,Q(n.name),1)]),o("td",ce,[h(se)("update-role")?(S(),ee(_,{key:0,class:"btn-action","no-caps":"",color:"blue",onClick:e=>g(n)},{default:c(()=>[...a[3]||(a[3]=[q("Edit",-1)])]),_:1},8,["onClick"])):te("",!0)])]))),128))])])])]),_:1})]),_:1}),l(ne,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=n=>p.value=n)},{default:c(()=>[l(w,{class:"card-md section"},{default:c(()=>[l(D,null,{default:c(()=>[o("div",fe,[a[5]||(a[5]=o("div",null,"Form Role",-1)),ae(l(_,{icon:"close",flat:"",round:""},null,512),[[le]])]),l(re,{onSubmit:m},{default:c(()=>[l(oe,{modelValue:h(r).name,"onUpdate:modelValue":a[0]||(a[0]=n=>h(r).name=n),label:"Name",required:""},null,8,["modelValue"]),o("div",me,[l(_,{type:"submit",class:"full-width",color:"primary",label:"Submit Data"})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{ye as default};
