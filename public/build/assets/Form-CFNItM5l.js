import{Q as w}from"./QSelect-DBKKVu0I.js";import{C as D,S as z,x as m,E as A,c as f,o as i,a as s,w as n,g as k,i as U,k as S,Q as P,b as l,u as r,H as F,e as y,F as T,K as I,L as _,T as M,M as j,N as R,O as q,U as H,j as N,P as Y,V as h}from"./app-BAS-jcsj.js";import{Q as G}from"./QForm-DmiplmYh.js";import{C as J}from"./ClosePopup-CzAQfUIi.js";const W={class:"card-title"},X={class:"table bordered"},Z={align:"right"},ee={class:"card-title"},te={class:"scroll",style:{"max-height":"360px"}},ue={__name:"Form",setup(le){const d=D().props.data,v=D().props.filters,B=[{label:"STOCK IN",value:"in"},{label:"STOCK OUT",value:"out"}],a=z({description:"",stock_type:"in",stock_items:[]}),L=()=>{d?a.put(h.update(d.id).url):a.post(h.store().url)},b=m(v),O=(t,e,o)=>{e(()=>{if(t){console.log(t);const u=t.toLowerCase();b.value=v.filter(p=>p.label.toLowerCase().indexOf(u)>-1)}else b.value=v})},V=m(!1),g=m(""),C=m([]),E=async()=>{C.value=[];const e=await(await fetch(`/api/products/list?product_id=${g.value}`)).json();C.value=e.data},Q=t=>a.stock_items.some(e=>e.product_line_id==t),K=t=>{Q(t.id)?a.stock_items=a.stock_items.filter(e=>e.product_line_id!=t.id):a.stock_items.push({product_name:t.title,product_line_id:t.id,sku_number:t.sku_number,quantity:0})},$=t=>{a.stock_items.splice(t,1)},x=m(!1),c=m(!0);return A(()=>{x.value=!0,d&&(c.value=d.can_update,a.description=d.description,a.stock_type=d.stock_type,d.items.forEach(t=>{a.stock_items.push({product_line_id:t.id,product_name:t.product.title,sku_number:t.product.sku_number,quantity:t.quantity})}))}),(t,e)=>(i(),f(T,null,[s(G,{onSubmit:L},{default:n(()=>[s(S,{class:"section"},{default:n(()=>[s(P,null,{default:n(()=>[e[5]||(e[5]=l("div",{class:"card-title"},"Detail",-1)),s(w,{readonly:x.value,options:B,label:"Stock Type",modelValue:r(a).stock_type,"onUpdate:modelValue":e[0]||(e[0]=o=>r(a).stock_type=o),"emit-value":"","map-options":""},null,8,["readonly","modelValue"]),s(F,{readonly:!c.value,label:"Description",modelValue:r(a).description,"onUpdate:modelValue":e[1]||(e[1]=o=>r(a).description=o)},null,8,["readonly","modelValue"])]),_:1})]),_:1}),s(S,{class:"section q-mt-md"},{default:n(()=>[s(P,null,{default:n(()=>[l("div",W,[e[6]||(e[6]=l("div",null,"Products",-1)),c.value?(i(),k(y,{key:0,label:"Add Product",color:"primary",size:"12px",onClick:e[2]||(e[2]=o=>V.value=!0)})):U("",!0)]),l("table",X,[e[7]||(e[7]=l("thead",null,[l("tr",null,[l("th",{align:"left"},"#"),l("th",{align:"left"},"SKU NUMBER"),l("th",{align:"left"},"PRODUCT"),l("th",{align:"left"},"QUANTITY"),l("th",{align:"right"},"Action")])],-1)),l("tbody",null,[(i(!0),f(T,null,I(r(a).stock_items,(o,u)=>(i(),f("tr",{key:u},[l("td",null,_(u+1),1),l("td",null,_(o.sku_number),1),l("td",null,_(o.product_name),1),l("td",null,[s(F,{readonly:!c.value,min:"1",required:"",style:{width:"100px"},outlined:"",dense:"",modelValue:r(a).stock_items[u].quantity,"onUpdate:modelValue":p=>r(a).stock_items[u].quantity=p,type:"number"},null,8,["readonly","modelValue","onUpdate:modelValue"])]),l("td",Z,[c.value?(i(),k(y,{key:0,dense:"",size:"12px",color:"red",icon:"delete",onClick:p=>$(u)},null,8,["onClick"])):U("",!0)])]))),128))])])]),_:1})]),_:1}),c.value?(i(),k(y,{key:0,label:"Submit Data",type:"submit",color:"primary",class:"q-mt-md"})):U("",!0)]),_:1}),s(Y,{modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=o=>V.value=o)},{default:n(()=>[s(S,{class:"section card-lg"},{default:n(()=>[s(P,null,{default:n(()=>[l("div",ee,[e[8]||(e[8]=l("div",null,"Product",-1)),M(s(y,{icon:"close",flat:"",round:""},null,512),[[J]])]),s(w,{dense:"",label:"Filter Product",filled:"",class:"q-mb-md",options:b.value,"map-options":"","emit-value":"",modelValue:g.value,"onUpdate:modelValue":[e[3]||(e[3]=o=>g.value=o),E],debounce:"700","use-input":"",onFilter:O},null,8,["options","modelValue"]),l("div",te,[s(j,{separator:""},{default:n(()=>[(i(!0),f(T,null,I(C.value,(o,u)=>(i(),k(R,{key:u,clickable:"",onClick:p=>K(o)},{default:n(()=>[s(q,{side:""},{default:n(()=>[s(H,{name:Q(o.id)?"check_box":"check_box_outline_blank",size:"md",color:Q(o.id)?"green":"grey-7"},null,8,["name","color"])]),_:2},1024),s(q,null,{default:n(()=>[N(_(o.sku_number),1)]),_:2},1024),s(q,null,{default:n(()=>[N(_(o.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ue as default};
